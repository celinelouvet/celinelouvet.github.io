import {
  Center,
  Flex,
  Icon,
  Image,
  ListItem,
  Stack,
  Text,
  UnorderedList,
  Wrap,
  WrapItem,
} from '@chakra-ui/react';
import { type FC } from 'react';
import { FaChevronCircleRight } from 'react-icons/fa';

import { ExternalLink, H3Heading, H4Heading } from '@/components/core';

import { ArticleContent, ArticleSummary } from './Article';

export const FeedbackSummary: FC<{ link: string }> = ({ link }) => {
  const image = {
    src: '/others/2-feedbacks/want-your-feedback.png',
    alt: 'I wan your feedback',
  };

  return (
    <ArticleSummary
      link={link}
      title="Feedbacks"
      when="2024-03-07"
      image={image}
    >
      <Stack spacing={0}>
        <Text>
          Suite √† la publication du pr√©c√©dent article, j‚Äòai eu des retours tr√®s
          pertinents. J‚Äòai donc appliqu√© ceux qui √©taient facilement
          r√©alisables. Je vous explique comment j‚Äòai fait √ßa.
        </Text>
        <Text>
          <Text as="b">TLDR: </Text>des feedbacks et une nouvelle version.
        </Text>
      </Stack>
    </ArticleSummary>
  );
};

export const FeedbackContent: FC = () => (
  <ArticleContent title="Feedbacks" when="2024-03-07">
    <>
      <Stack spacing={0}>
        <Text>
          Suite √† la publication du pr√©c√©dent article, j‚Äòai eu des retours tr√®s
          pertinents. J‚Äòai donc appliqu√© ceux qui √©taient facilement
          r√©alisables. Je vous explique comment j‚Äòai fait √ßa.
        </Text>
        <Text>
          <Text as="b">TLDR: </Text>des feedbacks et une nouvelle version.
        </Text>
      </Stack>

      <Stack spacing={4}>
        <H3Heading>Les feedbacks</H3Heading>

        <Stack spacing={2}>
          <Stack spacing={0}>
            <Text as="span">
              Quand j‚Äòai annonc√© la publication de la refonte, j‚Äòai re√ßu ces
              feedbacks :
            </Text>
            <UnorderedList paddingLeft={4}>
              <ListItem>Le chargement du site √©tait rapide,</ListItem>
              <ListItem>Le poids trop √©lev√© de certaines images,</ListItem>
              <ListItem>
                Le manque d‚Äòaccessibilit√© du menu de navigation,
              </ListItem>
              <ListItem>Une police majoritairement trop petite,</ListItem>
              <ListItem>
                La difficult√© √† voir ou comprendre le bouton &ldquo;plus de
                d√©tails&rdquo; sur la page CV.
              </ListItem>
            </UnorderedList>
          </Stack>

          <Text>
            J‚Äòai aussi re√ßu une demande d‚Äòajout de fonctionnalit√©: un flux RSS.
          </Text>
          <Text>
            Merci √† toutes les personnes qui ont pris le temps de me faire ces
            retours. √áa fait chaud au c≈ìur.
          </Text>
        </Stack>

        <Stack spacing={4}>
          <H4Heading>Rapidit√© de chargement du site</H4Heading>

          <Stack spacing={0}>
            <Text>
              Je ne pense pas y √™tre pour grand-chose. C‚Äòest surtout la stack
              choisie qui permet tout √ßa.
            </Text>
            <Text>
              Je me suis appuy√©e au d√©part sur
              <ExternalLink href="https://start-ui.com" marginX={1}>
                Start UI de BearStudio
              </ExternalLink>
              que j‚Äòai un peu purg√© pour supprimer ce qui ne m‚Äò√©tait pas
              n√©cessaire.
            </Text>
          </Stack>

          <Stack spacing={0}>
            <Text as="span">La stack est donc :</Text>

            <UnorderedList paddingLeft={4}>
              <ListItem>Typescript,</ListItem>
              <ListItem>
                <ExternalLink href="https://nextjs.org" marginX={1}>
                  NextJs
                </ExternalLink>
                pour le framework web. Il permet de profiter de composants React
                et il apporte une grande partie de l‚Äòoptimisation,
              </ListItem>
              <ListItem>
                <ExternalLink href="https://chakra-ui.com" marginX={1}>
                  Chakra UI
                </ExternalLink>
                pour la librairie de composants. Elle fournit des composants
                accessibles, avec des modes light et dark, un Design System.
              </ListItem>
            </UnorderedList>
          </Stack>

          <Stack spacing={2}>
            <Stack spacing={0}>
              <Text as="span">
                J‚Äòai choisi de d√©ployer le r√©sultat sur
                <ExternalLink
                  href="https://cloud.google.com/appengine?hl=en"
                  marginX={1}
                >
                  GCP AppEngine
                </ExternalLink>
                .
              </Text>
              <UnorderedList paddingLeft={4}>
                <ListItem>
                  C‚Äòest gratuit tant que l‚Äòusage reste en-dessous d‚Äòun quota, ce
                  qui est parfait pour un petit site perso.
                </ListItem>
                <ListItem>
                  On peut tr√®s facilement y d√©ployer du Nodejs, ce qui me
                  convient parfaitement.
                </ListItem>
                <ListItem>
                  C‚Äòest enti√®rement g√©r√© par GCP, donc je peux me concentrer sur
                  mon travail, le d√©veloppement.
                </ListItem>
              </UnorderedList>
            </Stack>
            <Stack spacing={0}>
              <Text>
                J‚Äòai configur√© mon instance pour qu‚Äòelle soit up en permanence,
                ce qui permet d‚Äò√©viter de subir trop de cold start.
              </Text>
              <Text>
                N√©anmoins le gros souci du d√©ploiement sur AppEngine, c‚Äòest le
                temps de d√©ploiement en tant que tel. Il varie entre
                <strong>2 minutes et 7-8 minutes</strong>.
              </Text>
            </Stack>
          </Stack>

          <Text>
            Pour la CI/CD, j‚Äòutilise Github Actions, car il y a des actions
            existantes pour GCP.
          </Text>
        </Stack>

        <Stack spacing={4}>
          <H4Heading>Poids trop √©lev√© des images</H4Heading>

          <Stack spacing={0}>
            <Text>
              Je n‚Äòavais clairement pas r√©fl√©chi √† ce probl√®me avant le feedback
              et c‚Äòest idiot de ma part üòÇ
            </Text>
            <Text>
              J‚Äòai donc r√©duit la taille des images pour qu‚Äòelles ne soient pas
              plus grandes que n√©cessaire. √áa ne sert √† rien d‚Äòavoir une image
              2000 x 1000 px, si c‚Äòest pour l‚Äòafficher en 200 x 100 px ! Pire
              que √ßa, √ßa ralentit le browser qui doit les r√©duire pour les
              afficher. √áa m‚Äòa permis d√©j√† de diminuer grandement le poids de
              celles ci.
            </Text>
            <Text>
              De plus, √† cette taille, autant les passer en JPG, si elles ne
              contiennent pas de transparence. √áa permet parfois de diviser le
              poids par 2.
            </Text>
            <Text>Donc maintenant la plupart de ces images font 10-20 ko.</Text>
          </Stack>
        </Stack>

        <Stack spacing={4}>
          <H4Heading>Manque d‚Äòaccessibilit√© du menu de navigation</H4Heading>

          <Stack spacing={0} marginBottom="6">
            <Text>
              Mon menu manquait tr√®s clairement d‚Äòaccessibilit√©. Il √©tait tr√®s
              difficile de voir quelle page √©tait s√©lectionn√©e.
            </Text>
            <Text>
              Je l‚Äòai donc revu pour utiliser directement des boutons afin qu‚Äòil
              soit plus accessible pour les lecteurs. J‚Äòai aussi align√© les
              boutons √† gauche pour pouvoir ajouter d‚Äòautres pages dans le
              futur.
            </Text>

            <Wrap spacing="8" align="center" justify="center">
              <WrapItem flexDirection="column" alignItems="center">
                <Text>Ancienne version</Text>
                <Center maxH="200px">
                  <Image
                    maxH={200}
                    objectFit="cover"
                    src="/others/2-feedbacks/desktop-before.jpg"
                    alt="Le menu avant modification, le texte est juste soulign√©"
                    loading="lazy"
                  />
                </Center>
              </WrapItem>
              <WrapItem>
                <Icon as={FaChevronCircleRight} boxSize="6" />
              </WrapItem>
              <WrapItem flexDirection="column" alignItems="center">
                <Text>Nouvelle version</Text>
                <Center maxH="200px">
                  <Image
                    maxH={200}
                    objectFit="cover"
                    src="/others/2-feedbacks/desktop-after.jpg"
                    alt="Le nouveau menu, avec des boutons de couleur"
                    loading="lazy"
                  />
                </Center>
              </WrapItem>
            </Wrap>
          </Stack>

          <Stack spacing={0}>
            <Text>
              Au passage, j‚Äòai cr√©√© une vraie version pour mobile qui j‚Äòesp√®re
              sera mieux. J‚Äòai enlev√© le pr√©c√©dent menu pour ajouter un panneau
              menu.
            </Text>

            <Wrap spacing="8" align="center" justify="center">
              <WrapItem flexDirection="column" alignItems="center">
                <Text>Ancienne version</Text>
                <Center maxH="200px">
                  <Image
                    maxH={200}
                    objectFit="cover"
                    src="/others/2-feedbacks/mobile-before.jpg"
                    alt="Le menu avant modification, les boutons sont tass√©s"
                    loading="lazy"
                  />
                </Center>
              </WrapItem>
              <WrapItem>
                <Icon as={FaChevronCircleRight} boxSize="6" />
              </WrapItem>
              <WrapItem flexDirection="column" alignItems="center">
                <Text>Nouvelle version</Text>
                <Flex>
                  <Center maxH="200px">
                    <Image
                      maxH={200}
                      objectFit="cover"
                      src="/others/2-feedbacks/mobile-after-1.jpg"
                      alt="Le nouveau menu, avec un bouton menu"
                      loading="lazy"
                    />
                  </Center>
                  <Center maxH="200px">
                    <Image
                      maxH={200}
                      objectFit="cover"
                      src="/others/2-feedbacks/mobile-after-2.jpg"
                      alt="Le panneau menu"
                      loading="lazy"
                    />
                  </Center>
                </Flex>
              </WrapItem>
            </Wrap>
          </Stack>
        </Stack>

        <Stack spacing={4}>
          <H4Heading>Police majoritairement trop petite</H4Heading>

          <Stack spacing={0} marginBottom="6">
            <Text>
              Ma police √©tait bien trop petite. J‚Äòutilisais du 14px en taille
              par d√©faut et parfois, je descendais jusqu‚Äò√† 10px. Maintenant, la
              police par d√©faut est 16px, mais je pense qu‚Äòelle est encore
              parfois trop petite... Je reverrais √ßa √† nouveau.
            </Text>
          </Stack>
        </Stack>

        <Stack spacing={4}>
          <H4Heading>
            Bouton &ldquo;plus de d√©tails&rdquo; sur la page CV
          </H4Heading>

          <Stack spacing={0} marginBottom="6">
            <Text>
              J‚Äòavais ajout√© un toggle sur le CV afin d‚Äòadapter le contenu √† la
              personne qui le lit. Quand ce toggle est actif, les exp√©riences
              affichaient plus de d√©tails.
            </Text>
            <Text>
              A la place, j‚Äòai mis une section d√©pliable par exp√©rience, suite √†
              une suggestion.
            </Text>

            <Wrap spacing="8" align="center" justify="center">
              <WrapItem flexDirection="column" alignItems="center">
                <Text>Ancienne version</Text>
                <Center maxH="200px">
                  <Image
                    maxH={200}
                    objectFit="cover"
                    src="/others/2-feedbacks/details-before.jpg"
                    alt="Le toggle principal"
                    loading="lazy"
                  />
                </Center>
              </WrapItem>
              <WrapItem>
                <Icon as={FaChevronCircleRight} boxSize="6" />
              </WrapItem>
              <WrapItem flexDirection="column" alignItems="center">
                <Text>Nouvelle version</Text>
                <Center maxH="200px">
                  <Image
                    maxH={200}
                    objectFit="cover"
                    src="/others/2-feedbacks/details-after.jpg"
                    alt="La section d√©pliable par exp√©rience"
                    loading="lazy"
                  />
                </Center>
              </WrapItem>
            </Wrap>
          </Stack>
        </Stack>

        <Stack spacing={4}>
          <H4Heading>Ajouter un flux RSS</H4Heading>

          <Stack spacing={0}>
            <Text>
              D√©sol√©e, mais je n‚Äòai vraiment pas eu le temps d‚Äòattaquer √ßa.
              Peut-√™tre en juin ?
            </Text>
            <Text>
              Si vous connaissez des librairies qui vont √ßa facilement en JS /
              TS, je suis tr√®s preneuse, encore plus s‚Äòil s‚Äòagit de librairies
              plug ‚Äòn‚Äò play en nextJs !
            </Text>
          </Stack>
        </Stack>

        <Stack spacing={0}>
          <Text>
            Si vous voulez voir les diff√©rences, je vais garder la version
            pr√©c√©dente pendant encore quelques temps.
          </Text>

          <ExternalLink
            href="https://v2-0-0-dot-celinelouvet-cv.ew.r.appspot.com"
            marginX={1}
          >
            Ancienne version
          </ExternalLink>
        </Stack>
      </Stack>

      <Stack spacing={4}>
        <H3Heading>Et c‚Äòest tout ?!</H3Heading>

        <Text>
          Non, ce n‚Äòest pas tout. J‚Äòen ai profit√© pour apporter 2-3 autres
          choses.
        </Text>

        <Text as="span">J‚Äòai fait :</Text>
        <UnorderedList paddingLeft={4} marginBottom="6">
          <ListItem>
            une mise √† jour de la stack: les packages sont √† jour et l‚Äòinstance
            tourne sur du node 20 maintenant !
          </ListItem>
          <ListItem>
            du m√©nage dans le design system et dans les stories storybook
          </ListItem>
          <ListItem>
            un micro-tracking maison: j‚Äòenregistre au fil de votre navigation
            les infos suivantes
            <UnorderedList paddingLeft={4}>
              <ListItem>la langue utilis√©e,</ListItem>
              <ListItem>le mode couleur (dark/light mode),</ListItem>
              <ListItem>la page o√π vous allez,</ListItem>
              <ListItem>si vous cliquez sur des zones d√©pliables.</ListItem>
              <ListItem>
                Et c‚Äòest tout ! Pas d‚Äòidentifiant, pas d‚ÄòIP, rien de personnel.
              </ListItem>
            </UnorderedList>
          </ListItem>
        </UnorderedList>

        <Text>
          Si vous avez des doutes sur vos donn√©es, n‚Äòh√©sitez pas √† aller faire
          un tour dans le
          <ExternalLink
            href="https://github.com/celinelouvet/celinelouvet.github.io"
            marginX={1}
          >
            code sur Github
          </ExternalLink>
          !
        </Text>
        <Text>Il me reste encore beaucoup √† faire !</Text>
      </Stack>

      <Stack spacing={2} alignItems="center">
        <Text>
          Et n‚Äòh√©sitez pas, je suis toujours preneuse de vos feedbacks, tant
          qu‚Äòils sont constructifs üôÇ
        </Text>
        <Image
          boxSize={200}
          objectFit="cover"
          src="/others/2-feedbacks/want-your-feedback-bigger.png"
          alt="Je veux votre feedback"
          loading="lazy"
        />
      </Stack>
    </>
  </ArticleContent>
);
